<!DOCTYPE HTML> 
<html>
<head>
    <title>生菜阅读 台历预约 2017</title>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
    <script src="../static/js/zepto.min.js" type="text/javascript"></script>
    <script src="../static/js/jquery-1.11.0.min.js"></script>
   <script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>    
    <script src="../static/js/weui.min.js"></script>

<link rel="stylesheet" href="http://res.wx.qq.com/open/libs/weui/1.1.0/weui.min.css" />
<link rel="icon" href="../static/favicon.ico">	
</head>
<body >


        <h1 class="page__title">
            <img src="../static/images/calendar2017/封面.jpg" width="100%" />
        </h1>
   
        <p class="page__desc">  <a href="../static/assets/calendar2017.pdf">点击预览 生菜阅读台历 2017 高清完整版(10MB)</a></p>
<div class="weui-cells__title">单价 RMB ￥25.00 /本 </div>
<div class="weui-cells weui-cells_form">
    
    <div class="weui-cell">
        <div class="weui-cell__hd"><label class="weui-label">数量</label></div>
        <div class="weui-cell__bd">
            <input class="weui-input" type="number"  pattern="[0-9]*" id="quantity"  placeholder="请输入您要预订的台历数量"/>
        </div>
    </div>
    
   <div class="weui-cell">
    	<div class="weui-cell__hd"><label class="weui-label">姓名</label></div>
        <div class="weui-cell__bd">
            <input class="weui-input" type="text" id="name"  placeholder="请输入收件人真实姓名"/>
        </div>
    </div>
    
   <div class="weui-cell ">

        <div class="weui-cell__hd"><label class="weui-label">手机号</label></div>
        <div class="weui-cell__bd">
            <input class="weui-input" type="number" id="phonenumber" pattern="[0-9]*" placeholder="请输入收件人手机号码"/>
        </div>
    </div>

    <div class="weui-cell">
         <div class="weui-cell__hd"><label class="weui-label">收件人地址</label></div>
        <div class="weui-cell__bd">
            <input class="weui-input" type="text" id="address" placeholder="请输入您的派送地址"/>
        </div>
    </div>


           
        <div class="weui-btn-area nav">
            <a class="weui-btn weui-btn_primary" id="gotoplay" onclick="gotoplay();" id="showTooltips">确定</a>
        </div>    
    </div>
    
    
    <!--<div class="weui-cells weui-cells_radio">
            <label class="weui-cell weui-check__label" for="x11">
                <div class="weui-cell__bd">
                    <p>白羊座 </p>
                </div>
                <div class="weui-cell__ft">
                    <input type="radio" class="weui-check" name="radio1" id="x11">
                    <span class="weui-icon-checked"></span>
                </div>
            </label>
            <label class="weui-cell weui-check__label" for="x12">
                <div class="weui-cell__bd">
                    <p>金牛座</p>
                </div>
                <div class="weui-cell__ft">
                    <input type="radio" class="weui-check" name="radio1" id="x12">
                    <span class="weui-icon-checked"></span>
                </div>
            </label>
            <label class="weui-cell weui-check__label" for="x13">
                <div class="weui-cell__bd">
                    <p>双子座</p>
                </div>
                <div class="weui-cell__ft">
                    <input type="radio" class="weui-check" name="radio1" id="x13">
                    <span class="weui-icon-checked"></span>
                </div>
            </label>
            <label class="weui-cell weui-check__label" for="x14">
                <div class="weui-cell__bd">
                    <p>巨蟹座</p>
                </div>
                <div class="weui-cell__ft">
                    <input type="radio" class="weui-check" name="radio1" id="x14">
                    <span class="weui-icon-checked"></span>
                </div>
            </label>

        </div>-->

</body>
    <script>
       function gotoplay() {
            
             var gourl = "http://applinzi.ddianke.com/PayBill/?prepay_id=";
            //if (Math.random()>0.8) {
            //gourl = 'http://mp.weixin.qq.com/s?__biz=MzIzNzA2MjU4MA==&mid=208803670&idx=1&sn=df9cf1daa7564b538b60966731896153&scene=0#rd';   
            //}
            quantity = document.getElementById("quantity").value;
           if (quantity == 0) 
           {
             
               alert('请选择预订数量！');
               return;
           }
           name = document.getElementById("name").value;
           if (name =="")
           {
               alert('请填写收件人姓名！');
               return;
           }
           phonenumber = document.getElementById("phonenumber").value;
           if (phonenumber == 0) 
           {
               alert('请填写收件人手机号！');
               return;
           }           
           address = document.getElementById("address").value;
           if (address=="")
           {
               alert('请填写收件人地址！');
               return;
           }
           data = {
                    "quantity":document.getElementById("quantity").value,
                    "name":document.getElementById("name").value,
                    "address":document.getElementById("address").value,
                    "phonenumber": document.getElementById("phonenumber").value
                 //""
                },


           		 $.ajax({
                 type: "POST",
                 url: "../prepay/",
                 async: false,
                 data: {
                      "quantity":document.getElementById("quantity").value,
                    "name":document.getElementById("name").value,
                    "address":document.getElementById("address").value,
                    "phonenumber": document.getElementById("phonenumber").value,
                    "openid": "{{userinfo.openID}}" 
                 //""
                },

                      success: function (res) {
                //alert(res);         
             if (res < 0)
             {
                alert('Error when creating order!');
             }
                          else
                          {
                               location.href=gourl+res;
                          }
            },
            error: function (msg) {
                alert(msg);
            }
           });                      
        };    
    </script>
<script>
wx.config({
    //{{ticket}}
    debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
    appId: '{{appid}}', // 必填，公众号的唯一标识
    timestamp: '{{sign.timestamp}}', // 必填，生成签名的时间戳
    nonceStr: '{{sign.nonceStr}}', // 必填，生成签名的随机串
    signature: '{{sign.signature}}',// 必填，签名，见附录1
    jsApiList: ['onMenuShareTimeline', 'onMenuShareAppMessage','chooseWXPay','openProductSpecificView','addCard','chooseCard','openCard'] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2
});


wx.ready(function () {

  var shareData = {
      title: '我刚在生菜阅读订购了2017版台历，你也来吧！',
      desc: '我刚订了生菜阅读台历2017版，设计精美，美女如云，你也来订吧！',
      link: 'http://applinzi.ddianke.com/eshop/',
      imgUrl: 'http://applinzi.ddianke.com/static/img/calendar2017.jpg'
  };
  wx.onMenuShareAppMessage(shareData);
  wx.onMenuShareTimeline(shareData);
      
  });    
wx.error(function(res){

     alert(res); // config信息验证失败会执行error函数，如签名过期导致验证失败，具体错误信息可以打开config的debug模式查看，也可以在返回的res参数中查看，对于SPA可以在这里更新签名。

});
</script>    



</html>